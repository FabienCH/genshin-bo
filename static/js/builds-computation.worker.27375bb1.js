/*! For license information please see builds-computation.worker.27375bb1.js.LICENSE.txt */
!function(t){var e={};function r(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(n,i,function(e){return t[e]}.bind(null,i));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="https://fabiench.github.io/genshin-bo/",r(r.s=1)}([,function(t,e,r){"use strict";function n(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function i(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function o(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?i(Object(r),!0).forEach((function(e){n(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function a(t){return function(t){if(Array.isArray(t))return s(t)}(t)||function(t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(t){if("string"===typeof t)return s(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?s(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function c(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function l(t,e,r){return e&&c(t.prototype,e),r&&c(t,r),t}r.r(e);var f=function(t,e){return(f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};function h(t,e){function r(){this.constructor=t}f(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}function p(t){return"function"===typeof t}var d=!1,y={Promise:void 0,set useDeprecatedSynchronousErrorHandling(t){t&&(new Error).stack;d=t},get useDeprecatedSynchronousErrorHandling(){return d}};function b(t){setTimeout((function(){throw t}),0)}var m={closed:!0,next:function(t){},error:function(t){if(y.useDeprecatedSynchronousErrorHandling)throw t;b(t)},complete:function(){}},v=function(){return Array.isArray||function(t){return t&&"number"===typeof t.length}}();function g(t){return null!==t&&"object"===typeof t}var S=function(){function t(t){return Error.call(this),this.message=t?t.length+" errors occurred during unsubscription:\n"+t.map((function(t,e){return e+1+") "+t.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=t,this}return t.prototype=Object.create(Error.prototype),t}(),w=function(){function t(t){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,t&&(this._ctorUnsubscribe=!0,this._unsubscribe=t)}return t.prototype.unsubscribe=function(){var e;if(!this.closed){var r=this,n=r._parentOrParents,i=r._ctorUnsubscribe,o=r._unsubscribe,s=r._subscriptions;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,n instanceof t)n.remove(this);else if(null!==n)for(var a=0;a<n.length;++a){n[a].remove(this)}if(p(o)){i&&(this._unsubscribe=void 0);try{o.call(this)}catch(l){e=l instanceof S?D(l.errors):[l]}}if(v(s)){a=-1;for(var u=s.length;++a<u;){var c=s[a];if(g(c))try{c.unsubscribe()}catch(l){e=e||[],l instanceof S?e=e.concat(D(l.errors)):e.push(l)}}}if(e)throw new S(e)}},t.prototype.add=function(e){var r=e;if(!e)return t.EMPTY;switch(typeof e){case"function":r=new t(e);case"object":if(r===this||r.closed||"function"!==typeof r.unsubscribe)return r;if(this.closed)return r.unsubscribe(),r;if(!(r instanceof t)){var n=r;(r=new t)._subscriptions=[n]}break;default:throw new Error("unrecognized teardown "+e+" added to Subscription.")}var i=r._parentOrParents;if(null===i)r._parentOrParents=this;else if(i instanceof t){if(i===this)return r;r._parentOrParents=[i,this]}else{if(-1!==i.indexOf(this))return r;i.push(this)}var o=this._subscriptions;return null===o?this._subscriptions=[r]:o.push(r),r},t.prototype.remove=function(t){var e=this._subscriptions;if(e){var r=e.indexOf(t);-1!==r&&e.splice(r,1)}},t.EMPTY=function(t){return t.closed=!0,t}(new t),t}();function D(t){return t.reduce((function(t,e){return t.concat(e instanceof S?e.errors:e)}),[])}var O=function(){return"function"===typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random()}(),_=function(t){function e(r,n,i){var o=t.call(this)||this;switch(o.syncErrorValue=null,o.syncErrorThrown=!1,o.syncErrorThrowable=!1,o.isStopped=!1,arguments.length){case 0:o.destination=m;break;case 1:if(!r){o.destination=m;break}if("object"===typeof r){r instanceof e?(o.syncErrorThrowable=r.syncErrorThrowable,o.destination=r,r.add(o)):(o.syncErrorThrowable=!0,o.destination=new k(o,r));break}default:o.syncErrorThrowable=!0,o.destination=new k(o,r,n,i)}return o}return h(e,t),e.prototype[O]=function(){return this},e.create=function(t,r,n){var i=new e(t,r,n);return i.syncErrorThrowable=!1,i},e.prototype.next=function(t){this.isStopped||this._next(t)},e.prototype.error=function(t){this.isStopped||(this.isStopped=!0,this._error(t))},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,t.prototype.unsubscribe.call(this))},e.prototype._next=function(t){this.destination.next(t)},e.prototype._error=function(t){this.destination.error(t),this.unsubscribe()},e.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},e.prototype._unsubscribeAndRecycle=function(){var t=this._parentOrParents;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=t,this},e}(w),k=function(t){function e(e,r,n,i){var o,s=t.call(this)||this;s._parentSubscriber=e;var a=s;return p(r)?o=r:r&&(o=r.next,n=r.error,i=r.complete,r!==m&&(p((a=Object.create(r)).unsubscribe)&&s.add(a.unsubscribe.bind(a)),a.unsubscribe=s.unsubscribe.bind(s))),s._context=a,s._next=o,s._error=n,s._complete=i,s}return h(e,t),e.prototype.next=function(t){if(!this.isStopped&&this._next){var e=this._parentSubscriber;y.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?this.__tryOrSetError(e,this._next,t)&&this.unsubscribe():this.__tryOrUnsub(this._next,t)}},e.prototype.error=function(t){if(!this.isStopped){var e=this._parentSubscriber,r=y.useDeprecatedSynchronousErrorHandling;if(this._error)r&&e.syncErrorThrowable?(this.__tryOrSetError(e,this._error,t),this.unsubscribe()):(this.__tryOrUnsub(this._error,t),this.unsubscribe());else if(e.syncErrorThrowable)r?(e.syncErrorValue=t,e.syncErrorThrown=!0):b(t),this.unsubscribe();else{if(this.unsubscribe(),r)throw t;b(t)}}},e.prototype.complete=function(){var t=this;if(!this.isStopped){var e=this._parentSubscriber;if(this._complete){var r=function(){return t._complete.call(t._context)};y.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?(this.__tryOrSetError(e,r),this.unsubscribe()):(this.__tryOrUnsub(r),this.unsubscribe())}else this.unsubscribe()}},e.prototype.__tryOrUnsub=function(t,e){try{t.call(this._context,e)}catch(r){if(this.unsubscribe(),y.useDeprecatedSynchronousErrorHandling)throw r;b(r)}},e.prototype.__tryOrSetError=function(t,e,r){if(!y.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{e.call(this._context,r)}catch(n){return y.useDeprecatedSynchronousErrorHandling?(t.syncErrorValue=n,t.syncErrorThrown=!0,!0):(b(n),!0)}return!1},e.prototype._unsubscribe=function(){var t=this._parentSubscriber;this._context=null,this._parentSubscriber=null,t.unsubscribe()},e}(_);var E=function(){return"function"===typeof Symbol&&Symbol.observable||"@@observable"}();function A(t){return t}function T(t){return 0===t.length?A:1===t.length?t[0]:function(e){return t.reduce((function(t,e){return e(t)}),e)}}var j=function(){function t(t){this._isScalar=!1,t&&(this._subscribe=t)}return t.prototype.lift=function(e){var r=new t;return r.source=this,r.operator=e,r},t.prototype.subscribe=function(t,e,r){var n=this.operator,i=function(t,e,r){if(t){if(t instanceof _)return t;if(t[O])return t[O]()}return t||e||r?new _(t,e,r):new _(m)}(t,e,r);if(n?i.add(n.call(i,this.source)):i.add(this.source||y.useDeprecatedSynchronousErrorHandling&&!i.syncErrorThrowable?this._subscribe(i):this._trySubscribe(i)),y.useDeprecatedSynchronousErrorHandling&&i.syncErrorThrowable&&(i.syncErrorThrowable=!1,i.syncErrorThrown))throw i.syncErrorValue;return i},t.prototype._trySubscribe=function(t){try{return this._subscribe(t)}catch(e){y.useDeprecatedSynchronousErrorHandling&&(t.syncErrorThrown=!0,t.syncErrorValue=e),!function(t){for(;t;){var e=t,r=e.closed,n=e.destination,i=e.isStopped;if(r||i)return!1;t=n&&n instanceof _?n:null}return!0}(t)?console.warn(e):t.error(e)}},t.prototype.forEach=function(t,e){var r=this;return new(e=B(e))((function(e,n){var i;i=r.subscribe((function(e){try{t(e)}catch(r){n(r),i&&i.unsubscribe()}}),n,e)}))},t.prototype._subscribe=function(t){var e=this.source;return e&&e.subscribe(t)},t.prototype[E]=function(){return this},t.prototype.pipe=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return 0===t.length?this:T(t)(this)},t.prototype.toPromise=function(t){var e=this;return new(t=B(t))((function(t,r){var n;e.subscribe((function(t){return n=t}),(function(t){return r(t)}),(function(){return t(n)}))}))},t.create=function(e){return new t(e)},t}();function B(t){if(t||(t=y.Promise||Promise),!t)throw new Error("no Promise impl found");return t}var P=function(){function t(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return t.prototype=Object.create(Error.prototype),t}(),R=function(t){function e(e,r){var n=t.call(this)||this;return n.subject=e,n.subscriber=r,n.closed=!1,n}return h(e,t),e.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var t=this.subject,e=t.observers;if(this.subject=null,e&&0!==e.length&&!t.isStopped&&!t.closed){var r=e.indexOf(this.subscriber);-1!==r&&e.splice(r,1)}}},e}(w),M=function(t){function e(e){var r=t.call(this,e)||this;return r.destination=e,r}return h(e,t),e}(_),x=function(t){function e(){var e=t.call(this)||this;return e.observers=[],e.closed=!1,e.isStopped=!1,e.hasError=!1,e.thrownError=null,e}return h(e,t),e.prototype[O]=function(){return new M(this)},e.prototype.lift=function(t){var e=new F(this,this);return e.operator=t,e},e.prototype.next=function(t){if(this.closed)throw new P;if(!this.isStopped)for(var e=this.observers,r=e.length,n=e.slice(),i=0;i<r;i++)n[i].next(t)},e.prototype.error=function(t){if(this.closed)throw new P;this.hasError=!0,this.thrownError=t,this.isStopped=!0;for(var e=this.observers,r=e.length,n=e.slice(),i=0;i<r;i++)n[i].error(t);this.observers.length=0},e.prototype.complete=function(){if(this.closed)throw new P;this.isStopped=!0;for(var t=this.observers,e=t.length,r=t.slice(),n=0;n<e;n++)r[n].complete();this.observers.length=0},e.prototype.unsubscribe=function(){this.isStopped=!0,this.closed=!0,this.observers=null},e.prototype._trySubscribe=function(e){if(this.closed)throw new P;return t.prototype._trySubscribe.call(this,e)},e.prototype._subscribe=function(t){if(this.closed)throw new P;return this.hasError?(t.error(this.thrownError),w.EMPTY):this.isStopped?(t.complete(),w.EMPTY):(this.observers.push(t),new R(this,t))},e.prototype.asObservable=function(){var t=new j;return t.source=this,t},e.create=function(t,e){return new F(t,e)},e}(j),F=function(t){function e(e,r){var n=t.call(this)||this;return n.destination=e,n.source=r,n}return h(e,t),e.prototype.next=function(t){var e=this.destination;e&&e.next&&e.next(t)},e.prototype.error=function(t){var e=this.destination;e&&e.error&&this.destination.error(t)},e.prototype.complete=function(){var t=this.destination;t&&t.complete&&this.destination.complete()},e.prototype._subscribe=function(t){return this.source?this.source.subscribe(t):w.EMPTY},e}(x);function C(){return"function"===typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}var V=C(),H=function(t){return t&&"number"===typeof t.length&&"function"!==typeof t};function N(t){return!!t&&"function"!==typeof t.subscribe&&"function"===typeof t.then}var U,W,I=function(t){if(t&&"function"===typeof t[E])return i=t,function(t){var e=i[E]();if("function"!==typeof e.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return e.subscribe(t)};if(H(t))return n=t,function(t){for(var e=0,r=n.length;e<r&&!t.closed;e++)t.next(n[e]);t.complete()};if(N(t))return r=t,function(t){return r.then((function(e){t.closed||(t.next(e),t.complete())}),(function(e){return t.error(e)})).then(null,b),t};if(t&&"function"===typeof t[V])return e=t,function(t){for(var r=e[V]();;){var n=void 0;try{n=r.next()}catch(i){return t.error(i),t}if(n.done){t.complete();break}if(t.next(n.value),t.closed)break}return"function"===typeof r.return&&t.add((function(){r.return&&r.return()})),t};var e,r,n,i,o=g(t)?"an invalid object":"'"+t+"'";throw new TypeError("You provided "+o+" where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.")};function z(t,e){if(null!=t){if(function(t){return t&&"function"===typeof t[E]}(t))return function(t,e){return new j((function(r){var n=new w;return n.add(e.schedule((function(){var i=t[E]();n.add(i.subscribe({next:function(t){n.add(e.schedule((function(){return r.next(t)})))},error:function(t){n.add(e.schedule((function(){return r.error(t)})))},complete:function(){n.add(e.schedule((function(){return r.complete()})))}}))}))),n}))}(t,e);if(N(t))return function(t,e){return new j((function(r){var n=new w;return n.add(e.schedule((function(){return t.then((function(t){n.add(e.schedule((function(){r.next(t),n.add(e.schedule((function(){return r.complete()})))})))}),(function(t){n.add(e.schedule((function(){return r.error(t)})))}))}))),n}))}(t,e);if(H(t))return function(t,e){return new j((function(r){var n=new w,i=0;return n.add(e.schedule((function(){i!==t.length?(r.next(t[i++]),r.closed||n.add(this.schedule())):r.complete()}))),n}))}(t,e);if(function(t){return t&&"function"===typeof t[V]}(t)||"string"===typeof t)return function(t,e){if(!t)throw new Error("Iterable cannot be null");return new j((function(r){var n,i=new w;return i.add((function(){n&&"function"===typeof n.return&&n.return()})),i.add(e.schedule((function(){n=t[V](),i.add(e.schedule((function(){if(!r.closed){var t,e;try{var i=n.next();t=i.value,e=i.done}catch(o){return void r.error(o)}e?r.complete():(r.next(t),this.schedule())}})))}))),i}))}(t,e)}throw new TypeError((null!==t&&typeof t||t)+" is not observable")}!function(t){t.flatHp="flatHp",t.percentHp="percentHp",t.flatAtk="flatAtk",t.percentAtk="percentAtk",t.flatDef="flatDef",t.percentDef="percentDef",t.elementalMastery="elementalMastery",t.energyRecharge="energyRecharge",t.critRate="critRate",t.critDmg="critDmg"}(U||(U={})),function(t){t.flatHp="flatHp",t.percentHp="percentHp",t.flatAtk="flatAtk",t.percentAtk="percentAtk",t.percentDef="percentDef",t.elementalMastery="elementalMastery",t.energyRecharge="energyRecharge",t.pyroDmg="pyroDmg",t.hydroDmg="hydroDmg",t.dendroDmg="dendroDmg",t.electroDmg="electroDmg",t.anemoDmg="anemoDmg",t.cryoDmg="cryoDmg",t.geoDmg="geoDmg",t.physicalDmg="physicalDmg",t.critRate="critRate",t.critDmg="critDmg",t.healingBonus="healingBonus"}(W||(W={}));var Y,L;a(new Set([].concat(a(Object.values(W)),a(Object.values(U)))));!function(t){t.percentAtk="percentAtk",t.elementalMastery="elementalMastery",t.healingBonus="healingBonus",t.pyroDmg="pyroDmg",t.hydroDmg="hydroDmg",t.dendroDmg="dendroDmg",t.electroDmg="electroDmg",t.anemoDmg="anemoDmg",t.cryoDmg="cryoDmg",t.geoDmg="geoDmg",t.physicalDmg="physicalDmg",t.powerfulShield="powerfulShield",t.pyroRes="pyroRes",t.hydroRes="hydroRes",t.dendroRes="dendroRes",t.electroRes="electroRes",t.anemoRes="anemoRes",t.cryoRes="cryoRes",t.geoRes="geoRes"}(Y||(Y={})),function(t){t.hp="hp",t.atk="atk",t.def="def",t.elementalMastery="elementalMastery",t.energyRecharge="energyRecharge",t.pyroDmg="pyroDmg",t.hydroDmg="hydroDmg",t.dendroDmg="dendroDmg",t.electroDmg="electroDmg",t.anemoDmg="anemoDmg",t.cryoDmg="cryoDmg",t.geoDmg="geoDmg",t.physicalDmg="physicalDmg",t.critRate="critRate",t.critDmg="critDmg",t.pyroRes="pyroRes",t.hydroRes="hydroRes",t.dendroRes="dendroRes",t.electroRes="electroRes",t.anemoRes="anemoRes",t.cryoRes="cryoRes",t.geoRes="geoRes",t.healingBonus="healingBonus",t.powerfulShield="powerfulShield"}(L||(L={}));var G,K=o(o(o(o({},L),W),U),Y);!function(t){t.gladiatorsFinale="gladiatorsFinale",t.noblesseOblige="noblesseOblige",t.wanderersTroupe="wanderersTroupe",t.maidenBeloved="maidenBeloved",t.retracingBolide="retracingBolide",t.crimsonWitchOfFlames="crimsonWitchOfFlames",t.lavawalker="lavawalker",t.heartOfDepth="heartOfDepth",t.thunderingFury="thunderingFury",t.thundersoother="thundersoother",t.viridescentVenerer="viridescentVenerer",t.blizzardStrayer="blizzardStrayer",t.archaicPetra="archaicPetra",t.bloodstainedChivalry="bloodstainedChivalry"}(G||(G={}));var $,J=function(){function t(){u(this,t),this.setsWithEffects=[{name:G.gladiatorsFinale,stat:Y.percentAtk,value:18},{name:G.wanderersTroupe,stat:Y.elementalMastery,value:80},{name:G.maidenBeloved,stat:Y.healingBonus,value:15},{name:G.retracingBolide,stat:Y.powerfulShield,value:35},{name:G.crimsonWitchOfFlames,stat:Y.pyroDmg,value:15},{name:G.lavawalker,stat:Y.pyroRes,value:40},{name:G.heartOfDepth,stat:Y.hydroDmg,value:15},{name:G.thunderingFury,stat:Y.electroDmg,value:15},{name:G.thundersoother,stat:Y.electroRes,value:40},{name:G.viridescentVenerer,stat:Y.anemoDmg,value:15},{name:G.blizzardStrayer,stat:Y.cryoDmg,value:15},{name:G.archaicPetra,stat:Y.geoDmg,value:15},{name:G.bloodstainedChivalry,stat:Y.physicalDmg,value:25}]}return l(t,[{key:"computeStats",value:function(t,e,r){var n=this.computeArtifactsStats(r),i=this.computeSetsStats(r),s=Object.keys(o(o(o({},e),n),i)),a=s.filter((function(t){return t.includes("percent")})),u=this.updateStats(a,e,n,i,t),c=s.filter((function(t){return!a.includes(t)}));return this.updateStats(c,e,n,i,u)}},{key:"addStats",value:function(t){var e=this;return t.reduce((function(t,r){return t=Math.round(10*(e.getStatValue(t)+e.getStatValue(r)))/10}),0)}},{key:"computeArtifactsStats",value:function(t){var e=this;return t.reduce((function(t,r){var n=Object.keys(r.mainStat)[0];return t[n]=e.addStats([t[n],r.mainStat[n]]),Object.keys(r.subStats).forEach((function(n){t[n]=e.addStats([t[n],r.subStats[n]])})),t}),{})}},{key:"computeSetsStats",value:function(t){var e=this,r=t.reduce((function(t,r){return t[r.set]=t[r.set]?e.getStatValue(t[r.set])+1:1,t}),{});return Object.keys(r).reduce((function(t,n){var i=e.setsWithEffects.find((function(t){return t.name===n&&e.getStatValue(r[n])>=2}));return i&&(t[i.stat]=i.value),t}),{})}},{key:"updateStats",value:function(t,e,r,n,i){var o=this;return t.reduce((function(t,i){var s=o.getBuildStatName(i),a=o.getStatValue(e[i]);return t[s]=o.computeStat(o.getStatValue(t[s]),[o.getStatValue(r[i]),o.getStatValue(n[i]),a],i.includes("percent")),t}),i)}},{key:"computeStat",value:function(t,e,r){return r?this.applyMultiplierToBuildStat(t,this.addStats(e)):this.addStats([t].concat(a(e)))}},{key:"applyMultiplierToBuildStat",value:function(t,e){return Math.round(t*(1+e/100))}},{key:"getBuildStatName",value:function(t){var e=[{buildStatName:L.atk,match:[K.flatAtk,K.percentAtk]},{buildStatName:L.def,match:[K.flatDef,K.percentDef]},{buildStatName:L.hp,match:[K.flatHp,K.percentHp]}].find((function(e){return e.match.includes(t)}));return e?e.buildStatName:t}},{key:"getStatValue",value:function(t){return!t||isNaN(t)?0:t}}]),t}(),Z=function(){function t(){u(this,t)}return l(t,null,[{key:"filterBuilds",value:function(t,e){var r=function(t){return!t||isNaN(t)?0:t};return!t||Object.keys(t).every((function(n){return r(e[n])>=r(t[n])}))}},{key:"setFilterMatch",value:function(t,e){return!t||t.setNames.filter((function(r){return e.filter((function(t){return t.set===r})).length>=t.pieces})).length>=t.setNames.length}}]),t}(),q=new Uint8Array(16);function Q(){if(!$&&!($="undefined"!==typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!==typeof msCrypto&&"function"===typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return $(q)}var X=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;for(var tt=function(t){return"string"===typeof t&&X.test(t)},et=[],rt=0;rt<256;++rt)et.push((rt+256).toString(16).substr(1));var nt=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=(et[t[e+0]]+et[t[e+1]]+et[t[e+2]]+et[t[e+3]]+"-"+et[t[e+4]]+et[t[e+5]]+"-"+et[t[e+6]]+et[t[e+7]]+"-"+et[t[e+8]]+et[t[e+9]]+"-"+et[t[e+10]]+et[t[e+11]]+et[t[e+12]]+et[t[e+13]]+et[t[e+14]]+et[t[e+15]]).toLowerCase();if(!tt(r))throw TypeError("Stringified UUID is invalid");return r};var it,ot=function(t,e,r){var n=(t=t||{}).random||(t.rng||Q)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,e){r=r||0;for(var i=0;i<16;++i)e[r+i]=n[i];return e}return nt(n)},st=function(){function t(){u(this,t)}return l(t,null,[{key:"filterArtifacts",value:function(t,e,r,n){var i=t.flowers,o=t.plumes,s=t.sands,a=t.goblets,u=t.circlets;return{flowers:i.filter((function(t){return t.matchFilters(r,n)})),plumes:o.filter((function(t){return t.matchFilters(r,n)})),sands:s.filter((function(t){return t.matchFiltersWithMain(r,n,e.sandsMain)})),goblets:a.filter((function(t){return t.matchFiltersWithMain(r,n,e.gobletMain)})),circlets:u.filter((function(t){return t.matchFiltersWithMain(r,n,e.circletMain)}))}}}]),t}();function at(t,e){return(at=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function ut(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&at(t,e)}function ct(t){return(ct=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function lt(t){return(lt="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ft(t,e){return!e||"object"!==lt(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ht(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=ct(t);if(e){var i=ct(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return ft(this,r)}}!function(t){t.flower="flower",t.plume="plume",t.sands="sands",t.goblet="goblet",t.circlet="circlet"}(it||(it={}));var pt=function(){function t(e,r,n,i,o,s){if(u(this,t),this.id=void 0,this.set=void 0,this.level=void 0,this.mainStat=void 0,this.subStats=void 0,this.mainStatValues=[{stats:[W.percentAtk,W.percentHp,W.pyroDmg,W.hydroDmg,W.dendroDmg,W.electroDmg,W.anemoDmg,W.cryoDmg,W.geoDmg],values:[7,9,11,12.9,14.9,16.9,18.9,20.9,22.8,24.8,26.8,28.8,30.8,32.8,34.7,36.7,38.7,40.7,42.7,44.6,46.6]},{stats:[W.percentDef,W.physicalDmg],values:[8.7,11.2,13.7,16.2,18.6,21.1,23.6,26.1,28.6,31,33.5,36,38.5,40.9,43.4,45.9,48.4,50.8,53.3,55.8,58.3]},{stats:[W.elementalMastery],values:[28,36,44,52,60,68,76,84,91,99,107,115,123,131,139,147,155,163,171,179,187]},{stats:[W.energyRecharge],values:[7.8,10,12.2,14.4,16.6,18.8,21,23.2,25.4,27.6,29.8,32,34.2,36.4,38.6,40.8,43,45.2,47.4,49.6,51.8]},{stats:[W.critRate],values:[4.7,6,7.3,8.6,9.9,11.3,12.6,13.9,15.2,16.6,17.9,19.2,20.5,21.8,23.2,24.5,25.8,27.1,28.4,29.8,31.1]},{stats:[W.critDmg],values:[9.3,12,14.6,17.3,19.9,22.5,25.2,27.8,30.5,33.1,35.7,38.4,41,43.7,46.3,49,51.6,54.2,56.9,59.5,62.2]},{stats:[W.healingBonus],values:[5.4,6.9,8.4,10,11.5,13,14.5,16.1,17.6,19.1,20.6,22.1,23.7,25.2,26.7,28.2,29.8,31.3,32.8,34.4,35.9]},{stats:[W.flatHp],values:[717,920,1123,1326,1530,1733,1936,2139,2342,2545,2749,2952,3155,3358,3561,3764,3967,4171,4374,4577,4780]},{stats:[W.flatAtk],values:[47,60,73,86,100,113,126,139,152,166,179,192,205,219,232,245,258,272,285,298,311]}],Object.keys(n).length<3)throw new Error("an artifact can not have less than 3 substats");if(i>3&&3===Object.keys(n).length)throw new Error("an artifact with level higher than 3 must have 4 substats");if(Object.keys(n).length>4)throw new Error("an artifact can not have more than 4 substats");if(Object.keys(n).find((function(t){return t===o})))throw new Error("main stat can not be the same as one of the substats");var a=this.getMainStat(o,i),c=Object.values(a)[0];if(s&&c!==s)throw new Error("inconsistent main stat value, value from level is ".concat(c));this.id=e,this.set=r,this.level=i,this.subStats=n,this.mainStat=this.getMainStat(o,this.level)}return l(t,[{key:"matchFilters",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1?arguments[1]:void 0;return this.level>=t&&this.filterByFocusStats(e)}},{key:"filterByFocusStats",value:function(t){return 0===t.length||!!Object.keys(o(o({},this.subStats),this.mainStat)).find((function(e){return t.includes(e)}))}},{key:"getMainStat",value:function(t,e){var r=this.mainStatValues.find((function(e){return e.stats.includes(t)}));if(!r)throw new Error("could not find values for main stat ".concat(t));return n({},t,r.values[e])}}]),t}(),dt=function(t){ut(r,t);var e=ht(r);function r(){return u(this,r),e.apply(this,arguments)}return l(r,[{key:"getType",value:function(){return it.circlet}},{key:"matchFiltersWithMain",value:function(t,e,r){var n=e&&r?[].concat(a(e),[r]):e;return(!r||Object.keys(this.mainStat)[0]===r)&&this.matchFilters(t,n)}}]),r}(pt),yt=function(t){ut(r,t);var e=ht(r);function r(t,n,i,o,s){return u(this,r),e.call(this,t,n,i,o,r.mainStat,s)}return l(r,[{key:"getType",value:function(){return it.flower}}]),r}(pt);yt.mainStat=W.flatHp;var bt=function(t){ut(r,t);var e=ht(r);function r(){return u(this,r),e.apply(this,arguments)}return l(r,[{key:"getType",value:function(){return it.goblet}},{key:"matchFiltersWithMain",value:function(t,e,r){var n=e&&r?[].concat(a(e),[r]):e;return(!r||Object.keys(this.mainStat)[0]===r)&&this.matchFilters(t,n)}}]),r}(pt),mt=function(t){ut(r,t);var e=ht(r);function r(t,n,i,o,s){return u(this,r),e.call(this,t,n,i,o,r.mainStat,s)}return l(r,[{key:"getType",value:function(){return it.plume}}]),r}(pt);mt.mainStat=W.flatAtk;var vt=function(t){ut(r,t);var e=ht(r);function r(){return u(this,r),e.apply(this,arguments)}return l(r,[{key:"getType",value:function(){return it.sands}},{key:"matchFiltersWithMain",value:function(t,e,r){var n=e&&r?[].concat(a(e),[r]):e;return(!r||Object.keys(this.mainStat)[0]===r)&&this.matchFilters(t,n)}}]),r}(pt),gt=function(){function t(){u(this,t)}return l(t,null,[{key:"formatStringWithUpperCase",value:function(t){var e=this.upperCaseFirstChar(t).match(/[A-Z][a-z]+/g);return e?e.join(" "):t}},{key:"upperCaseFirstChar",value:function(t){return t.charAt(0).toUpperCase()+t.slice(1)}}]),t}(),St=function(){function t(){u(this,t)}return l(t,null,[{key:"mapDataToView",value:function(e){var r=t.mapDataToArtifact(e);return t.mapArtifactToView(r)}},{key:"mapArtifactToView",value:function(e){var r=Object.values(e.subStats),i=Object.keys(e.subStats).map((function(t,e){return n({},t,r[e])}));return{id:e.id,type:gt.upperCaseFirstChar(e.getType()),set:gt.formatStringWithUpperCase(e.set),level:e.level,mainStat:t.statToString(e.mainStat),subStat1:t.statToString(i[0]),subStat2:t.statToString(i[1]),subStat3:t.statToString(i[2]),subStat4:i[3]?t.statToString(i[3]):"-"}}},{key:"mapDataToArtifact",value:function(e,r){switch(e.type){case"flower":return t.newFlowerArtifact(e,r);case"plume":return t.newPlumeArtifact(e,r);case"sands":return t.newSandsArtifact(e,r);case"goblet":return t.newGobletArtifact(e,r);case"circlet":return t.newCircletArtifact(e,r);default:throw new Error("incorrect artifact type")}}},{key:"mapOcrDataToArtifactData",value:function(e){var r=e.type,n=e.set,i=e.level,o=e.mainStatType,s=e.subStats,a=e.mainStatValue;if(null!=r&&null!=n&&null!=i&&null!=o&&null!=s){var u={id:ot(),type:r,set:n,level:i,mainStatType:o,subStats:s};return t.mapDataToArtifact({id:ot(),type:r,set:n,level:i,mainStatType:o,subStats:s},a),u}throw new Error("missing artifact data (type:".concat(r,", set:").concat(n,", level:").concat(i,", mainStatType:").concat(o,", subStats:").concat(JSON.stringify(s),")"))}},{key:"mapAllDataToAllArtifactsByType",value:function(e){return e.reduce((function(e,r){switch(r.type){case"flower":e.flowers=[].concat(a(e.flowers),[t.newFlowerArtifact(r)]);break;case"plume":e.plumes=[].concat(a(e.plumes),[t.newPlumeArtifact(r)]);break;case"sands":e.sands=[].concat(a(e.sands),[t.newSandsArtifact(r)]);break;case"goblet":e.goblets=[].concat(a(e.goblets),[t.newGobletArtifact(r)]);break;case"circlet":e.circlets=[].concat(a(e.circlets),[t.newCircletArtifact(r)])}return e}),{flowers:[],plumes:[],sands:[],goblets:[],circlets:[]})}},{key:"newCircletArtifact",value:function(t,e){return new dt(t.id,t.set,t.subStats,t.level,t.mainStatType,e)}},{key:"newGobletArtifact",value:function(t,e){return new bt(t.id,t.set,t.subStats,t.level,t.mainStatType,e)}},{key:"newSandsArtifact",value:function(t,e){return new vt(t.id,t.set,t.subStats,t.level,t.mainStatType,e)}},{key:"newPlumeArtifact",value:function(t,e){return new mt(t.id,t.set,t.subStats,t.level,e)}},{key:"newFlowerArtifact",value:function(t,e){return new yt(t.id,t.set,t.subStats,t.level,e)}},{key:"statToString",value:function(t){var e=Object.keys(t)[0],r=this.statKeyToStatName(e),n=e.includes("flat")||"elementalMastery"===e?"":"%";return"".concat(Object.values(t)[0]).concat(n," ").concat(r)}},{key:"statKeyToStatName",value:function(t){return t.includes("Hp")?"HP":t.includes("Atk")?"ATK":t.includes("Def")?"DEF":t.includes("Dmg")?"".concat(gt.upperCaseFirstChar(t.split("Dmg")[0])," DMG"):gt.formatStringWithUpperCase(t)}}]),t}(),wt=function(){function t(){u(this,t),this.statsComputation=void 0,this.newBuildsSub=new x,this.builds=void 0,this.allArtifacts=void 0,this.baseStats=void 0,this.characterBonusStat=void 0,this.setFilter=void 0,this.statsFilter=void 0,this.artifactsPerBuild=void 0,this.buildsComputed=void 0,this.buildsMatchingFilters=void 0,this.totalBuilds=void 0,this.lastBuildsEmitPercent=void 0,this.lastBuildsEmitTimestamp=void 0,this.statsComputation=new J}return l(t,[{key:"computeBuilds",value:function(t,e,r,n,i){var o={setNames:n.currentSets,pieces:n.setPieces};this.setAllArtifacts(n,t),this.baseStats=e,this.characterBonusStat=r,this.setFilter=o,this.statsFilter=i,this.builds=[],this.artifactsPerBuild=this.allArtifacts.length-1,this.lastBuildsEmitPercent=0,this.lastBuildsEmitTimestamp=Date.now(),this.initBuildsProgressCounters(),this.iterateOverAllBuilds([],0),this.emitNewBuildsSub()}},{key:"getBuildsCombinations",value:function(t,e){return this.setAllArtifacts(t,e),this.getTotalBuilds()}},{key:"getNewBuilds",value:function(){return t=this.newBuildsSub,e?z(t,e):t instanceof j?t:new j(I(t));var t,e}},{key:"iterateOverAllBuilds",value:function(e,r){var n=this;this.allArtifacts[r].every((function(i){var o=a(e);return o.push(i),r===n.artifactsPerBuild?(n.buildsComputed++,Z.setFilterMatch(n.setFilter,o)&&n.computeBuildStats(o),n.emitNewBuildsIfNeeded(),!0):(n.iterateOverAllBuilds(o,r+1),n.buildsMatchingFilters<t.buildsLimit)}))}},{key:"computeBuildStats",value:function(t){var e=this.statsComputation.computeStats(o({},this.baseStats),this.characterBonusStat,t);if(Z.filterBuilds(this.statsFilter,e)){var r=t.map((function(t){return t.id}));this.builds.push({id:ot(),stats:e,artifactIds:r}),this.buildsMatchingFilters++}}},{key:"setAllArtifacts",value:function(t,e){var r=t.mainsStats,n=t.minArtifactLevel,i=t.focusStats,o=St.mapAllDataToAllArtifactsByType(e);this.allArtifacts=Object.values(st.filterArtifacts(o,r,n,i))}},{key:"initBuildsProgressCounters",value:function(){if(this.buildsComputed=0,this.buildsMatchingFilters=0,this.totalBuilds=this.getTotalBuilds(),this.totalBuilds>Math.pow(10,10))throw new Error("total builds combinations can not be higher than 10 billions")}},{key:"getTotalBuilds",value:function(){return this.allArtifacts?this.allArtifacts.reduce((function(t,e){return t*=e.length}),1):0}},{key:"emitNewBuildsIfNeeded",value:function(){var t=100*this.buildsComputed/this.totalBuilds,e=Date.now(),r=e-this.lastBuildsEmitTimestamp;(t-this.lastBuildsEmitPercent>2&&r>100||r>1e3)&&(this.lastBuildsEmitTimestamp=e,this.lastBuildsEmitPercent=t,this.emitNewBuildsSub())}},{key:"emitNewBuildsSub",value:function(){this.newBuildsSub.next({builds:this.builds,progress:{computed:this.buildsComputed,total:this.totalBuilds}}),this.builds=[]}}]),t}();wt.buildsLimit=1e3;e.default={};self.addEventListener("message",(function(t){var e=t.data,r=e.allArtifacts,n=e.baseStats,i=e.characterBonusStat,o=e.artifactsFilters,s=e.statsFilter,a=new wt;a.getNewBuilds().subscribe((function(t){self.postMessage({buildsResults:t})})),a.computeBuilds(r,n,i,o,s)}))}]);
//# sourceMappingURL=builds-computation.worker.27375bb1.js.map